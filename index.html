<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nut and Sacha Wedding</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tangerine:wght@400;700&display=swap" rel="stylesheet">

  <style>
    .font-tangerine { font-family: 'Tangerine', cursive; }
    .font-courier { font-family: 'Courier New', monospace; }
    .font-georgia { font-family: 'Georgia', serif; }

    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    @keyframes fadeSlideUp {
      0% { opacity: 0; transform: translate(-50%, -40%); }
      100% { opacity: 1; transform: translate(-50%, -50%); }
    }
    .overlay-anim { animation: fadeSlideUp 1.5s ease-out; }

    @keyframes flipIn {
      0% { transform: rotateX(90deg); opacity: 0; }
      100% { transform: rotateX(0); opacity: 1; }
    }
    .flip-animate { animation: flipIn 0.7s ease-in-out; }

    .fade { opacity: 0; transition: opacity .6s ease; }
    .fade.show { opacity: 1; }

    /* Preloader */
    #preloader {
      position: fixed;
      inset: 0;
      background: #fff;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: opacity 0.8s ease, visibility 0.8s ease;
    }
    #preloader.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .loader {
      border: 4px solid #ddd;
      border-top: 4px solid #222;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .gallery-hover img { transition: transform 0.4s ease; }
    .gallery-hover:hover img { transform: scale(1.05); }

    /* Smooth countdown UI (no blinking) */
.timebox{
  background: rgba(255,255,255,.18);
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,.25);
  border-radius: 14px;
  padding: .65rem .75rem;
  text-align: center;
  box-shadow: 0 6px 20px rgba(0,0,0,.10);
}
.timebox .value{
  font-family: 'Courier New', monospace;
  font-variant-numeric: tabular-nums;
  font-weight: 700;
  font-size: clamp(22px, 4.5vw, 36px);
  line-height: 1.1;
  transform: translateY(0);
  transition: transform .28s ease;
  will-change: transform;
}
.timebox .label{
  font-size: .7rem;
  letter-spacing: .04em;
  opacity: .85;
}

/* Subtle “tick” motion only when the number changes — no opacity change */
.value.tick { transform: translateY(-8%); }

  </style>
</head>
<body class="bg-white text-gray-900">

  <!-- PRELOADER -->
  <div id="preloader">
    <div class="loader mb-4"></div>
    <p class="font-courier text-gray-700">Loading memories...</p>
  </div>

  <div class="w-full">
    <!-- Section 1: Hero -->
    <section class="relative h-screen w-full">
      <video id="heroVideo" autoplay muted loop playsinline class="absolute inset-0 h-full w-full object-cover fade"></video>
      <div class="absolute inset-0 bg-black/30"></div>
      <div class="overlay-anim absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-center text-white px-3 z-10">
        <h1 class="font-tangerine font-bold text-6xl md:text-7xl drop-shadow">Nutnaree & Sacha</h1>
        <p class="font-courier text-lg md:text-xl mt-2">29 December 2025</p>
        <p class="font-courier text-lg md:text-xl">Rama9, Bangkok</p>
        <!-- Countdown (smooth, non-blinking) -->
<div id="countdown" class="mt-5 grid grid-cols-4 gap-3 w-full max-w-xl mx-auto">
  <div class="timebox">
    <div id="days" class="value">00</div>
    <div class="label">Days</div>
  </div>
  <div class="timebox">
    <div id="hours" class="value">00</div>
    <div class="label">Hours</div>
  </div>
  <div class="timebox">
    <div id="minutes" class="value">00</div>
    <div class="label">Minutes</div>
  </div>
  <div class="timebox">
    <div id="seconds" class="value">00</div>
    <div class="label">Seconds</div>
  </div>
</div>

      </div>
    </section>

    <!-- Section 2 -->
    <section class="py-8 text-center">
      <p class="font-courier text-base">THE HONOUR OF YOUR PRESENCE IS REQUESTED</p>
      <p class="font-courier text-base">AT THE MARRIAGE CELEBRATION OF</p>
    </section>

    <!-- Section 3 -->
    <section class="px-4 max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="flex flex-col items-center">
        <img id="brideImg" alt="Bride" class="rounded-full object-cover w-[25vh] h-[25vh] p-2 shadow fade" />
        <p class="font-tangerine text-3xl mt-2">Bride</p>
        <p class="font-georgia text-xl">Nutnaree Luksachob</p>
      </div>
      <div class="flex flex-col items-center">
        <img id="groomImg" alt="Groom" class="rounded-full object-cover w-[25vh] h-[25vh] p-2 shadow fade" />
        <p class="font-tangerine text-3xl mt-2">Groom</p>
        <p class="font-georgia text-xl">Sacha XXXXX</p>
      </div>
    </section>

    <!-- Section 4 -->
    <section class="mt-8 px-4 text-center">
      <img id="logoImg" alt="Logo" class="mx-auto w-[30vh] h-auto fade" />
      <div class="mt-4">
        <p class="font-courier text-base">LET'S CELEBRATE TOGETHER ON</p>
        <p class="font-courier text-base">OUR SPECIAL DAY ON</p>
        <p class="font-courier text-2xl font-semibold">29 DEC 2025</p>
      </div>
    </section>

    <!-- Carousel -->
    <section class="my-10">
      <div class="relative">
        <div id="snapCarousel" class="w-full overflow-x-auto no-scrollbar snap-x snap-mandatory flex gap-4 px-4"></div>
        <div class="mt-4 flex justify-center gap-3">
          <button id="prevBtn" class="px-4 py-2 rounded-full bg-gray-900 text-white/90 hover:text-white hover:bg-gray-800">Prev</button>
          <button id="nextBtn" class="px-4 py-2 rounded-full bg-gray-900 text-white/90 hover:text-white hover:bg-gray-800">Next</button>
        </div>
      </div>
    </section>

<section class="py-10 bg-[#fafafa]">
  <h4 class="text-center mb-6 font-courier">More Memories</h4>
  <div id="gallery" class="max-w-6xl mx-auto px-4 grid grid-cols-2 md:grid-cols-3 gap-4">
    <!-- images will be injected here -->
  </div>
</section>


    <!-- Split -->
    <section class="grid grid-cols-1 lg:grid-cols-2 min-h-screen">
      <div class="flex items-center justify-center text-center p-6">
        <div>
          <p class="font-courier text-2xl md:text-3xl leading-relaxed">
            “เพื่อให้เราสามารถวางแผนในการดูแลท่าน ซึ่งเป็นแขกคนสำคัญได้อย่างเต็มที่
            ขอรบกวนทุกท่านทำแบบตอบรับการเข้าร่วมงานให้เราด้วยนะคะ/ครับ”
          </p>
          <p class="font-courier text-2xl md:text-3xl mt-6">“HOPE TO SEE YOU AT OUR WEDDING”</p>
        </div>
      </div>
      <div><img id="splitImg" alt="Split" class="w-full h-full object-cover fade" /></div>
    </section>

    <!-- Map -->
    <section class="mt-10 mb-12 px-4">
      <h4 class="text-center mb-4 font-courier">Wedding Location</h4>
      <div class="max-w-5xl mx-auto">
        <div class="w-full [aspect-ratio:16/9]">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3875.850136597468!2d100.49281291536477!3d13.75633039035286!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x30e2992e2df7f5c3%3A0xa1e4c8e7b98a898!2sGrand%20Palace!5e0!3m2!1sen!2sth!4v1685349642793!5m2!1sen!2sth"
            class="w-full h-full rounded-lg shadow" style="border:0;" allowfullscreen loading="lazy">
          </iframe>
        </div>
      </div>
    </section>
  </div>

  <!-- Firebase + Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDxlQWFYRcbGZ133HPEMXYy8tR_KMUiJw0",
      authDomain: "lottogame-16083.firebaseapp.com",
      projectId: "lottogame-16083",
      storageBucket: "lottogame-16083.firebasestorage.app",
      messagingSenderId: "278778623701",
      appId: "1:278778623701:web:c7828b036c617a13fa145c"
    };

    const app = initializeApp(firebaseConfig);
    const storage = getStorage(app);

    const files = {
      video: "BeachVDO3.mp4",
      heroImages: ["BeachPhoto24.jpg", "BeachPhoto2.jpg", "BeachPhoto8.jpg", "BeachPhoto15.jpg"],
      gallery: ["Studio18.jpg", "Studio33.jpg", "Studio12.jpg", "Studio19.jpg", "Studio11.jpg", "Studio26.jpg"],
      bride: "Studio22.jpg",
      groom: "Studio23.jpg",
      split: "Studio26.jpg",
      logo: "logo.png"
    };

    const fadeIn = (el) => el.classList.add("show");

// Enhanced setSrc – handles <video> separately
async function setSrc(el, file) {
  if (el.tagName === "VIDEO") {
    return setVideo(el, file);
  }
  try {
    const url = await getDownloadURL(ref(storage, file));
    el.src = url;
    el.addEventListener("load", () => fadeIn(el), { once: true });
  } catch (e) {
    console.error("Image load failed:", file, e);
  }
}

// Specific handler for video elements
async function setVideo(videoEl, file) {
  try {
    const url = await getDownloadURL(ref(storage, file));
    videoEl.src = url;
    videoEl.muted = true;
    videoEl.playsInline = true;
    videoEl.autoplay = true;

    // Wait until the video is ready to play
    videoEl.addEventListener("canplay", async () => {
      fadeIn(videoEl);
      try {
        await videoEl.play();
      } catch (err) {
        console.warn("Autoplay blocked:", err);
        const overlay = document.getElementById("videoPlayOverlay");
        overlay?.classList.remove("opacity-0", "pointer-events-none");
      }
    }, { once: true });

  } catch (e) {
    console.error("Video load failed:", file, e);
  }
}


    async function buildCarousel() {
      const scroller = document.getElementById("snapCarousel");
      scroller.innerHTML = "";
      for (const name of files.heroImages) {
        const url = await getDownloadURL(ref(storage, name));
        const img = document.createElement("img");
        img.src = url;
        img.alt = name;
        img.className = "snap-center shrink-0 w-full md:w-[80%] lg:w-[70%] h-[45vh] md:h-[65vh] object-cover rounded-xl shadow fade";
        img.addEventListener("load", () => fadeIn(img), { once: true });
        scroller.appendChild(img);
      }
      const step = () => scroller.clientWidth * 0.8;
      document.getElementById('prevBtn')?.addEventListener('click', () => scroller.scrollBy({ left: -step(), behavior: 'smooth' }));
      document.getElementById('nextBtn')?.addEventListener('click', () => scroller.scrollBy({ left: step(), behavior: 'smooth' }));
    }

    async function buildGallery() {
  const gallery = document.getElementById("gallery");
  gallery.innerHTML = "";
  for (const name of files.gallery) {
    const url = await getDownloadURL(ref(storage, name));

    // Container with centered image
    const div = document.createElement("div");
    div.className = "gallery-hover flex items-center justify-center bg-white rounded-lg overflow-hidden shadow-md aspect-[3/4]"; 
    // aspect-[3/4] ensures portrait ratio slots

    // Image fits within slot without cropping
    div.innerHTML = `
      <img src="${url}" alt="${name}" 
           class="max-h-full max-w-full object-contain transition-transform duration-300 ease-in-out hover:scale-105 fade" />
    `;

    const img = div.querySelector("img");
    img.addEventListener("load", () => fadeIn(img), { once: true });
    gallery.appendChild(div);
  }
}


    async function loadMedia() {
  const heroVideo = document.getElementById("heroVideo");

  // Start loading everything in parallel
  await Promise.all([
    setSrc(heroVideo, files.video),
    setSrc(document.getElementById("brideImg"), files.bride),
    setSrc(document.getElementById("groomImg"), files.groom),
    setSrc(document.getElementById("splitImg"), files.split),
    setSrc(document.getElementById("logoImg"), files.logo),
    buildCarousel(),
    buildGallery()
  ]);

  // Wait until video can actually play before hiding preloader
  if (heroVideo.readyState >= 3) {
    // readyState 3 = HAVE_FUTURE_DATA, video can start playing
    document.getElementById("preloader").classList.add("hidden");
  } else {
    heroVideo.addEventListener(
      "canplaythrough",
      () => {
        document.getElementById("preloader").classList.add("hidden");
      },
      { once: true }
    );
  }
}


    // ---- SMOOTH COUNTDOWN (no blink, clean motion) ----
const weddingDate = new Date("2025-12-29T17:00:00+07:00").getTime();

function setVal(id, newVal) {
  const el = document.getElementById(id);
  if (!el) return;
  const next = String(newVal).padStart(2, '0');
  if (el.textContent === next) return; // unchanged → skip
  el.textContent = next;
  el.classList.add('tick');
  setTimeout(() => el.classList.remove('tick'), 280);
}

function updateCountdown() {
  const now = Date.now();
  const distance = weddingDate - now;

  if (distance <= 0) {
    const wrap = document.getElementById("countdown");
    if (wrap) wrap.innerHTML = "<p class='font-courier text-xl'>It's Wedding Time!</p>";
    return;
  }

  const days = Math.floor(distance / (1000 * 60 * 60 * 24));
  const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  const seconds = Math.floor((distance % (1000 * 60)) / 1000);

  setVal("days", days);
  setVal("hours", hours);
  setVal("minutes", minutes);
  setVal("seconds", seconds);
}

updateCountdown();
setInterval(updateCountdown, 1000);


    loadMedia();
  </script>
</body>
</html>
